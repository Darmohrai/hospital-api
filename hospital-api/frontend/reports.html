<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Система Звітності</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="css/style.css">
    <style>
        .report-card { transition: all 0.3s; }
        .report-card:hover { box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .result-box { max-height: 400px; overflow-y: auto; border: 1px solid #eee; padding: 10px; display: none; }
    </style>
</head>
<body>

<header>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="index.html">МедСистема: Звіти</a>
            <div class="d-flex">
                <a href="index.html" class="btn btn-outline-light btn-sm me-2">На Головну</a>
                <button class="btn btn-outline-warning btn-sm" id="logout-button">Вийти</button>
            </div>
        </div>
    </nav>
</header>

<main class="container mt-5 pt-4">
    <h2 class="mb-4 text-center"><i class="bi bi-bar-chart-fill text-primary"></i> Генератор Звітів</h2>

    <div id="error-alert" class="alert alert-danger" style="display:none;"></div>

    <ul class="nav nav-tabs mb-4" id="reportTabs" role="tablist">
        <li class="nav-item">
            <button class="nav-link active" id="tab-general" data-bs-toggle="tab" data-bs-target="#content-general" type="button">Загальні та Пацієнти</button>
        </li>
        <li class="nav-item">
            <button class="nav-link" id="tab-capacity" data-bs-toggle="tab" data-bs-target="#content-capacity" type="button">Інфраструктура</button>
        </li>
        <li class="nav-item">
            <button class="nav-link" id="tab-staff" data-bs-toggle="tab" data-bs-target="#content-staff" type="button">Персонал</button>
        </li>
        <li class="nav-item">
            <button class="nav-link" id="tab-med" data-bs-toggle="tab" data-bs-target="#content-med" type="button">Діяльність (Операції/Лаб)</button>
        </li>
    </ul>

    <div class="tab-content" id="reportTabContent">

        <div class="tab-pane fade show active" id="content-general">
            <div class="row g-4">
                <div class="col-md-6">
                    <div class="card report-card h-100">
                        <div class="card-header bg-primary text-white">1. Щоденні візити</div>
                        <div class="card-body">
                            <form id="form-daily-app">
                                <div class="mb-2"><input type="date" class="form-control" name="date" required></div>
                                <div class="mb-2"><select class="form-select select-doctor" name="doctorId"><option value="">Всі лікарі</option></select></div>
                                <button type="submit" class="btn btn-primary w-100">Отримати</button>
                            </form>
                            <div id="res-daily-app" class="result-box mt-3"></div>
                        </div>
                    </div>
                </div>

                <div class="col-md-6">
                    <div class="card report-card h-100">
                        <div class="card-header bg-info text-dark">6. Пацієнти за профілем (Поліклініка)</div>
                        <div class="card-body">
                            <form id="form-patients-spec">
                                <div class="mb-2"><select class="form-select select-clinic" name="clinicId" required><option value="">Оберіть поліклініку</option></select></div>
                                <div class="mb-2"><select class="form-select select-specialty" name="specialty" required><option value="">Оберіть спеціальність</option></select></div>
                                <button type="submit" class="btn btn-info w-100">Отримати список</button>
                            </form>
                            <div id="res-patients-spec" class="result-box mt-3"></div>
                        </div>
                    </div>
                </div>

                <div class="col-md-12">
                    <div class="card report-card">
                        <div class="card-header bg-success text-white">7. Виписані зі стаціонару</div>
                        <div class="card-body">
                            <form id="form-inpatient" class="row g-2">
                                <div class="col-md-3"><input type="date" class="form-control" name="startDate" required placeholder="З"></div>
                                <div class="col-md-3"><input type="date" class="form-control" name="endDate" required placeholder="По"></div>
                                <div class="col-md-4"><select class="form-select select-hospital" name="hospitalId"><option value="">Всі лікарні</option></select></div>
                                <div class="col-md-2"><button type="submit" class="btn btn-success w-100">Звіт</button></div>
                            </form>
                            <div id="res-inpatient" class="result-box mt-3"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="tab-pane fade" id="content-capacity">
            <div class="row g-4">
                <div class="col-md-6">
                    <div class="card report-card h-100">
                        <div class="card-header bg-warning text-dark">2. Місткість лікарні</div>
                        <div class="card-body">
                            <form id="form-hospital-cap">
                                <div class="mb-2"><select class="form-select select-hospital" name="hospitalId" required><option value="">Оберіть лікарню</option></select></div>
                                <button type="submit" class="btn btn-warning w-100">Аналіз місць</button>
                            </form>
                            <div id="res-hospital-cap" class="result-box mt-3"></div>
                        </div>
                    </div>
                </div>

                <div class="col-md-6">
                    <div class="card report-card h-100">
                        <div class="card-header bg-secondary text-white">13. Завантаженість відділення</div>
                        <div class="card-body">
                            <form id="form-dept-occupancy">
                                <div class="mb-2">
                                    <select class="form-select select-hospital" id="trigger-dept-load">
                                        <option value="">1. Оберіть лікарню</option>
                                    </select>
                                </div>
                                <div class="mb-2">
                                    <select class="form-select" name="departmentId" id="dept-select" disabled required>
                                        <option value="">2. Оберіть відділення</option>
                                    </select>
                                </div>
                                <button type="submit" class="btn btn-secondary w-100">Перевірити палати</button>
                            </form>
                            <div id="res-dept-occupancy" class="result-box mt-3"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="tab-pane fade" id="content-staff">
            <div class="row g-4">
                <div class="col-md-12">
                    <div class="card report-card">
                        <div class="card-header bg-dark text-white">8. Розширений пошук лікарів</div>
                        <div class="card-body">
                            <form id="form-doc-filter" class="row g-2">
                                <div class="col-md-3"><select class="form-select select-specialty" name="specialty"><option value="">Спеціальність</option></select></div>
                                <div class="col-md-3"><input type="number" class="form-control" name="minWorkExperience" placeholder="Мін. стаж (років)"></div>
                                <div class="col-md-3"><select class="form-select" name="degree"><option value="">Наук. ступінь (Всі)</option><option value="0">Немає</option><option value="1">Кандидат</option><option value="2">Доктор</option></select></div>
                                <div class="col-md-3"><select class="form-select" name="title"><option value="">Вчене звання (Всі)</option><option value="0">Немає</option><option value="1">Доцент</option><option value="2">Професор</option></select></div>
                                <div class="col-md-12 text-end"><button type="submit" class="btn btn-dark">Знайти</button></div>
                            </form>
                            <div id="res-doc-filter" class="result-box mt-3"></div>
                        </div>
                    </div>
                </div>

                <div class="col-md-6">
                    <div class="card report-card h-100">
                        <div class="card-header bg-danger text-white">9 & 11. Хірургічна статистика</div>
                        <div class="card-body">
                            <ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">
                                <li class="nav-item"><button class="nav-link active btn-sm" data-bs-toggle="pill" data-bs-target="#pills-ops">Кількість операцій</button></li>
                                <li class="nav-item"><button class="nav-link btn-sm" data-bs-toggle="pill" data-bs-target="#pills-fatal">Рейтинг летальності</button></li>
                            </ul>
                            <div class="tab-content">
                                <div class="tab-pane fade show active" id="pills-ops">
                                    <form id="form-doc-ops">
                                        <input type="number" class="form-control mb-2" name="minOperationCount" placeholder="Мін. к-ть операцій" required value="1">
                                        <button type="submit" class="btn btn-danger w-100">Звіт</button>
                                    </form>
                                    <div id="res-doc-ops" class="result-box mt-2"></div>
                                </div>
                                <div class="tab-pane fade" id="pills-fatal">
                                    <form id="form-doc-fatal">
                                        <button type="submit" class="btn btn-outline-danger w-100">Завантажити рейтинг</button>
                                    </form>
                                    <div id="res-doc-fatal" class="result-box mt-2"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-md-6">
                    <div class="card report-card h-100">
                        <div class="card-header bg-secondary text-white">10. Обслуговуючий персонал</div>
                        <div class="card-body">
                            <form id="form-support-staff">
                                <div class="mb-2">
                                    <select class="form-select" name="role" required>
                                        <option value="0">Медсестра (Nurse)</option>
                                        <option value="1">Санітар (Orderly)</option>
                                        <option value="2">Прибиральник (Cleaner)</option>
                                    </select>
                                </div>
                                <button type="submit" class="btn btn-secondary w-100">Показати список</button>
                            </form>
                            <div id="res-support-staff" class="result-box mt-3"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="tab-pane fade" id="content-med">
            <div class="row g-4">
                <div class="col-md-6">
                    <div class="card report-card h-100">
                        <div class="card-header bg-primary text-white">3. Лабораторний звіт</div>
                        <div class="card-body">
                            <form id="form-lab">
                                <div class="input-group mb-2">
                                    <input type="date" class="form-control" name="startDate" required>
                                    <input type="date" class="form-control" name="endDate" required>
                                </div>
                                <button type="submit" class="btn btn-primary w-100">Аналізувати</button>
                            </form>
                            <div id="res-lab" class="result-box mt-3"></div>
                        </div>
                    </div>
                </div>

                <div class="col-md-6">
                    <div class="card report-card h-100">
                        <div class="card-header bg-danger text-white">5. Реєстр проведених операцій</div>
                        <div class="card-body">
                            <form id="form-pat-ops">
                                <div class="input-group mb-2">
                                    <input type="date" class="form-control" name="startDate" required>
                                    <input type="date" class="form-control" name="endDate" required>
                                </div>
                                <div class="mb-2"><select class="form-select select-hospital" name="hospitalId"><option value="">Всі лікарні</option></select></div>
                                <button type="submit" class="btn btn-danger w-100">Пошук</button>
                            </form>
                            <div id="res-pat-ops" class="result-box mt-3"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>
</main>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="js/api.js"></script>
<script src="js/auth.js"></script>
<script src="js/main.js"></script>
<script src="js/reports.js"></script>
</body>
</html>